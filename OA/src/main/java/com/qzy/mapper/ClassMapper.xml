<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.qzy.mapper.ClassMapper">
    <insert id="addClasses">
        insert into t_class values (null,#{major_id},#{className},#{class_date},#{class_time},#{class_address},0)
    </insert>
    <update id="updateClass">
        update t_class set major_id=#{major_id},class_name=#{className},class_date=#{class_date},class_time=#{class_time},class_address=#{class_address} where id=#{id}
    </update>
    <update id="deleteClassById">
        update t_class set class_delete = 1 where id=#{id}
    </update>

    <select id="getAllClassesByPage" resultMap="ClassMap">
        select c.*,m.id,m.major_name from t_class c inner join t_major m on class_delete = 0 and c.major_id=m.id limit #{pageStart},#{pageSize}
    </select>
    <select id="getTotalCount" resultType="java.lang.Integer">
        select count(id) from t_class where class_delete = 0;
    </select>
    <select id="selectClassById" resultMap="ClassMap">
        select c.*,m.major_name from t_class c inner join t_major m on c.id=#{id}
    </select>
    <select id="getAllMajorType" resultType="com.qzy.bean.MajorType">
        select * from t_majortype;
    </select>
    <select id="getAllMajorName" resultType="com.qzy.bean.Major">
        select * from t_major where major_delete=0;
    </select>
    <resultMap id="ClassMap" type="Classes">
        <id column="id" property="id"/>
        <result column="major_id" property="major_id"/>
        <result column="class_name" property="className"/>
        <result column="class_date" property="class_date"/>
        <result column="class_time" property="class_time"/>
        <result column="class_address" property="class_address"/>
        <result column="class_delete" property="class_delete"/>
        <association property="major" javaType="Major">
            <id column="id" property="id"/>
            <result column="major_name" property="major_name"/>
        </association>
    </resultMap>
</mapper>